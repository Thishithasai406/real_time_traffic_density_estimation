# üöó Real-Time Traffic Density Estimation with YOLOv8


A comprehensive AI-powered traffic monitoring system developed using **Python**, **YOLOv8**, and **OpenCV**. This system provides real-time vehicle detection, lane-wise counting, and traffic intensity analysis for urban traffic management and city planning.


<p align="center">
  <video src="https://github.com/user-attachments/assets/5107366a-4ab4-4c86-9079-5b249596aee9" width="500" autoplay loop muted></video>
</p>

--- 

## üö¶ Project Overview
This repository implements a real-time Traffic Density Estimation pipeline using a fine-tuned YOLOv8 model (You Only Look Once version 8). It detects vehicles in video frames, counts vehicles in designated lane regions, and annotates traffic intensity (e.g., Smooth / Heavy).

The goal is to create an intelligent system capable of detecting cars, buses, and trucks from road or aerial traffic videos to estimate traffic density and assist in smart city traffic management.

This project supports sustainable mobility by helping optimize traffic flow and reduce fuel wastage, contributing to green technology development.

---

## üìö Dataset Description
- Name: Top-View Vehicle Detection Image Dataset for YOLOv8
- Classes: single combined class "Vehicle" (cars, trucks, buses)
- Total images: 626 (640√ó640 px)
- Split: 536 train / 90 validation
- Annotations: YOLO format (xmin_center_y_center_width_height normalized)
- Source & access:
  - Roboflow: https://universe.roboflow.com/farzad/vehicle_detection_yolov8
  - Kaggle: https://www.kaggle.com/datasets/farzadnekouei/top-view-vehicle-detection-image-dataset
- Preprocessing: uniform resizing (640√ó640), optional augmentations (flips, etc.)

---

## üöÄ Features
### üéØ Real-time Vehicle Detection
- **YOLOv8 Model**: Fine-tuned deep learning model for accurate vehicle detection
- **Multi-class Support**: Detects cars, trucks, buses, and other vehicles
- **High Accuracy**: Optimized for aerial/top-view traffic scenarios
- **Fast Inference**: Real-time processing at high FPS with GPU acceleration

### üìä Traffic Monitoring Dashboard
- **Lane-wise Vehicle Counting**: Separate count for left and right lanes
- **Traffic Intensity Analysis**: Real-time classification (Smooth / Heavy)
- **Visual Overlays**: Dynamic polygon ROIs with count annotations
- **Frame-by-frame Processing**: Continuous video stream analysis
- **Automated Alerts**: Visual alerts for congestion detection
- **Video Export**: Processed output saved as AVI file

### üõ£Ô∏è Advanced Traffic Analysis
- **ROI Definition**: Customizable quadrilateral regions for lane detection
- **Threshold-based Classification**: Configurable vehicle count thresholds
- **Real-time Visualization**: Live bounding boxes and density heatmaps
- **Performance Metrics**: Frame processing statistics and inference timing
- **Data Logging**: Support for export and analysis of traffic patterns

### üé® Modern Implementation
- **Responsive Processing**: Handles variable video resolutions
- **Configurable Parameters**: Easy tuning for different scenarios
- **Clean Architecture**: Modular and maintainable codebase
- **Cross-platform**: Runs on Windows, Linux, and macOS

---

## üõ†Ô∏è Technologies Used
| Tool / Library | Purpose |
|-----------------|----------|
| **Python** | Main programming language |
| **YOLOv8 (Ultralytics)** | Object detection and model training |
| **OpenCV** | Image and video frame processing |
| **NumPy & Matplotlib** | Data handling and visualization |
| **Roboflow / Kaggle** | Dataset collection and management |
| **VS Code** | Development, model training, and evaluation environment |

---

## üìÇ Project Structure

```
Traffic_Density_Estimation/
|
‚îú‚îÄ‚îÄ real_time_traffic_analysis.py                 # Main inference script (real-time processing)
‚îú‚îÄ‚îÄ sample_video.mp4                              # Sample input video
‚îú‚îÄ‚îÄ processed_sample_video.avi                    # Output video generated by script
‚îú‚îÄ‚îÄ README.md                                     # Project documentation
‚îú‚îÄ‚îÄ models/                                       # Model directory
‚îÇ   ‚îî‚îÄ‚îÄ best.pt                                   # Fine-tuned YOLOv8 model (not included)
‚îÇ
‚îú‚îÄ‚îÄ images/                                       # sample images
```

---



## üöÄ Installation & Setup
1. **Clone the repository**
   ```bash
   https://github.com/Thishithasai406/real_time_traffic_density_estimation.git
  cd real_time_traffic_density_estimation
   ```

2. **Create a virtual environment** (recommended)
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

3. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```
   Or install manually:
   ```bash
   pip install ultralytics opencv-python numpy torch torchvision
   ```

4. **Download the dataset** (optional, for model training)
   - Kaggle: https://www.kaggle.com/datasets/farzadnekouei/top-view-vehicle-detection-image-dataset
   - Roboflow: https://universe.roboflow.com/farzad/vehicle_detection_yolov8

5. **Run the application**
   ```bash
   python real_time_traffic_analysis.py
   ```

6. **Access the output**
   - Live display window shows real-time analysis
   - Processed video saved as `processed_sample_video.avi`

---

## üì± Usage Guide

### Getting Started
1. **Prepare Input**: Place video file at `sample_video.mp4` or update path in script
2. **Load Model**: Ensure `models/best.pt` exists (fine-tuned YOLOv8)
3. **Run Script**: Execute `real_time_traffic_analysis.py`
4. **Monitor Output**: Watch real-time analysis in display window
5. **Export Results**: Output video automatically saved
   
--- 

## üîß Configuration

### Key Script Parameters

Edit `real_time_traffic_analysis.py` to customize:

```python
# Model Configuration
best_model = YOLO('models/best.pt')  # Model path
imgsz = 640                           # Inference size
conf = 0.4                            # Confidence threshold

# Traffic Thresholds
heavy_traffic_threshold = 10          # Vehicles count for "Heavy"

# ROI Definition (Region of Interest)
x1, x2 = 325, 635                     # Vertical slice range
lane_threshold = 609                  # X-coordinate for lane split
vertices1 = [(465, 350), (609, 350), (510, 630), (2, 630)]    # Left lane polygon
vertices2 = [(678, 350), (815, 350), (1203, 630), (743, 630)] # Right lane polygon

# Video I/O
input_video = 'sample_video.mp4'
output_video = 'processed_sample_video.avi'
frame_rate = 20.0
```

---

## üéØ Future Enhancements

- **Real-time Multi-object Tracking (MOT)**: SORT / DeepSORT integration for trajectory tracking
- **Speed Estimation**: Calculate vehicle speeds using optical flow or tracking
- **Vehicle Classification**: Distinguish between cars, trucks, buses with class-specific counting
- **Weather Integration**: Incorporate real weather API data
- **Cloud Deployment**: Flask web dashboard for remote monitoring
- **Mobile App**: Native iOS/Android application for field monitoring
- **Predictive Analytics**: ML model to forecast traffic patterns
- **Multi-camera Support**: Federated detection from multiple angles
- **Alert System**: SMS/Email notifications for congestion events
- **Database Integration**: PostgreSQL/MongoDB for historical data storage

---

## ü§ù Contributing
Contributions are always welcome! If you spot a bug, have an idea for improvement, or want to add a new feature, feel free to open an issue or submit a pull request. Suggestions for documentation updates, translations, or performance enhancements are also appreciated. Every contribution, big or small, helps improve the project for everyone.

---

**Built with ‚ù§Ô∏è for Smart Transportation & Urban Planning**
